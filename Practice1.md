# Введение в теорию игр: основы и применение в программировании

Теория игр — это раздел математики, который изучает стратегическое взаимодействие между игроками (агентами). Она применяется в экономике, политологии, биологии, а также в программировании, особенно в разработке искусственного интеллекта, алгоритмов и анализе данных. В этом материале мы разберём основные понятия теории игр, рассмотрим примеры и научимся применять их на практике.

---

## Основные понятия теории игр

### Игроки
Игроки — это участники игры, которые принимают решения. В теории игр игроки могут быть людьми, компаниями, алгоритмами или даже животными. Каждый игрок стремится максимизировать свою выгоду.

**Пример 1:** В игре "Камень-ножницы-бумага" два игрока одновременно выбирают одну из трёх стратегий.

**Пример 2:** В аукционе игроками являются участники, которые делают ставки, чтобы выиграть лот.

### Стратегии
Стратегия — это набор действий, которые может выбрать игрок. Стратегии могут быть:
- **Чистыми:** Конкретный выбор (например, "камень" в "Камень-ножницы-бумага").
- **Смешанными:** Вероятностный выбор (например, выбор "камень" с вероятностью 1/3, "ножницы" с вероятностью 1/3 и "бумага" с вероятностью 1/3).

**Пример 1:** В игре "Орёл и решка" чистая стратегия — это выбор "орёл" или "решка".

**Пример 2:** В покере смешанная стратегия — это выбор между "коллировать", "повысить" или "сбросить" с определёнными вероятностями.

### Выигрыши
Выигрыш — это результат, который получает игрок в зависимости от выбранных стратегий. Выигрыши могут быть выражены в виде чисел, которые отражают полезность для игрока.

**Пример 1:** В "Камень-ножницы-бумага" выигрыш может быть +1 за победу, 0 за ничью и -1 за проигрыш.

**Пример 2:** В экономической игре выигрыш может выражаться в денежных единицах или в процентах прибыли.

### Матрица выигрышей
Матрица выигрышей — это таблица, которая показывает выигрыши игроков для всех возможных комбинаций стратегий.

**Пример:** Матрица выигрышей для "Камень-ножницы-бумага":

|           | Камень | Ножницы | Бумага |
|-----------|--------|---------|--------|
| **Камень**  | (0, 0) | (1, -1) | (-1, 1)|
| **Ножницы** | (-1, 1)| (0, 0)  | (1, -1)|
| **Бумага**  | (1, -1)| (-1, 1) | (0, 0) |

---

## Типы игр

### Кооперативные vs некооперативные игры
- **Кооперативные игры:** Игроки могут заключать соглашения и действовать сообща.
- **Некооперативные игры:** Игроки действуют независимо, без соглашений.

**Пример 1:** Шахматы — это некооперативная игра, так как игроки не могут договариваться.
**Пример 2:** Переговоры между компаниями — это кооперативная игра, так как стороны могут заключать соглашения.

### С нулевой суммой vs с ненулевой суммой
- **Игры с нулевой суммой:** Сумма выигрышей всех игроков равна нулю (выигрыш одного игрока равен проигрышу другого).
- **Игры с ненулевой суммой:** Сумма выигрышей может быть положительной или отрицательной.

**Пример 1:** Покер — игра с нулевой суммой, так как выигрыш одного игрока равен проигрышу другого.
**Пример 2:** "Дилемма заключённого" — игра с ненулевой суммой, так как общий выигрыш зависит от выбора игроков.

---

## Равновесие Нэша

Равновесие Нэша — это ситуация, в которой ни один игрок не может увеличить свой выигрыш, изменив свою стратегию, если другие игроки свои стратегии не меняют.

**Пример:** В "Дилемме заключённого" равновесие Нэша — это когда оба игрока выбирают "предать", даже если сотрудничество выгоднее для обоих.

### Как найти равновесие Нэша
1. Для каждого игрока определите лучший ответ на стратегии других игроков.
2. Найдите комбинацию стратегий, где каждый игрок выбирает лучший ответ на стратегии других.

**Пример:** Рассмотрим игру с матрицей выигрышей:

|           | Игрок 2: A | Игрок 2: B |
|-----------|------------|------------|
| **Игрок 1: A** | (3, 3)     | (0, 5)     |
| **Игрок 1: B** | (5, 0)     | (1, 1)     |

Равновесие Нэша здесь — (B, A), так как ни один игрок не может улучшить свой выигрыш, изменив стратегию.

---

## Применение теории игр в программировании

Теория игр используется в разработке AI, анализе данных, сетевой маршрутизации и многом другом.

**Пример 1:** В разработке игр AI использует теорию игр для выбора оптимальной стратегии.
**Пример 2:** В экономике теория игр помогает моделировать поведение компаний на рынке.

### Пример на Python: Симуляция "Дилеммы заключённого"

```python
import random

# Стратегии игроков
strategies = ['Сотрудничать', 'Предать']

# Выигрыши
payoff_matrix = {
    ('Сотрудничать', 'Сотрудничать'): (3, 3),
    ('Сотрудничать', 'Предать'): (0, 5),
    ('Предать', 'Сотрудничать'): (5, 0),
    ('Предать', 'Предать'): (1, 1)
}

# Симуляция игры
def play_game():
    player1 = random.choice(strategies)
    player2 = random.choice(strategies)
    return payoff_matrix[(player1, player2)]

# Запуск симуляции
result = play_game()
print(f"Игрок 1: {result[0]}, Игрок 2: {result[1]}")
```

---

## Интересные примеры и задачи на теорию игр

### Пример 1: Дилемма заключённого
**Описание:** Два преступника арестованы за совместное преступление. Их допрашивают отдельно. У каждого есть выбор: сотрудничать (молчать) или предать (свидетельствовать против другого). Выигрыши зависят от их решений.

**Матрица выигрышей:**

|                     | Заключённый 2: Молчать | Заключённый 2: Предать |
|---------------------|------------------------|------------------------|
| **Заключённый 1: Молчать** | (-1, -1)               | (-10, 0)               |
| **Заключённый 1: Предать**  | (0, -10)               | (-5, -5)               |

**Вопросы:**
1. Найдите равновесие Нэша.
2. Почему сотрудничество выгоднее для обоих, но они выбирают предать?

**Ответ:**
1. Равновесие Нэша — (Предать, Предать), так как ни один игрок не может улучшить свой выигрыш, изменив стратегию.
2. Сотрудничество выгоднее, но каждый игрок стремится минимизировать свои потери, что приводит к худшему исходу для обоих.

---

### Пример 2: Битва полов
**Описание:** Муж и жена хотят провести вечер вместе, но у них разные предпочтения: муж хочет смотреть футбол, а жена — кино. Они должны выбрать, куда пойти, не зная выбора другого.

**Матрица выигрышей:**

|                     | Жена: Футбол | Жена: Кино |
|---------------------|--------------|------------|
| **Муж: Футбол**      | (3, 2)       | (0, 0)     |
| **Муж: Кино**        | (0, 0)       | (2, 3)     |

**Вопросы:**
1. Найдите равновесия Нэша.
2. Как можно улучшить исход для обоих игроков?

**Ответ:**
1. Равновесия Нэша — (Футбол, Футбол) и (Кино, Кино).
2. Игроки могут договориться заранее или использовать смешанные стратегии для достижения компромисса.

---

### Пример 3: Игра "Орёл и решка"
**Описание:** Два игрока одновременно выбирают "орёл" или "решку". Если выборы совпадают, выигрывает первый игрок, если нет — второй.

**Матрица выигрышей:**

|                     | Игрок 2: Орёл | Игрок 2: Решка |
|---------------------|---------------|----------------|
| **Игрок 1: Орёл**    | (1, -1)       | (-1, 1)        |
| **Игрок 1: Решка**   | (-1, 1)       | (1, -1)        |

**Вопросы:**
1. Найдите равновесие Нэша.
2. Какую стратегию следует использовать, чтобы минимизировать потери?

**Ответ:**
1. Равновесия Нэша нет в чистых стратегиях, но есть в смешанных: каждый игрок выбирает "орёл" и "решку" с вероятностью 0.5.
2. Оптимальная стратегия — случайный выбор с равными вероятностями.

---

### Пример 4: Аукцион второй цены (Викри)
**Описание:** На аукционе каждый участник делает ставку, не зная ставок других. Победитель платит вторую по величине ставку.

**Вопросы:**
1. Почему участникам выгодно делать ставки, равные их истинной оценке товара?
2. Как это связано с равновесием Нэша?

**Ответ:**
1. Делая ставку, равную истинной оценке, участник максимизирует свою полезность, так как он либо выигрывает по выгодной цене, либо не переплачивает.
2. Это равновесие Нэша, так как ни один участник не может увеличить свою полезность, изменив ставку.

---

### Пример 5: Игра "Цыплёнок"
**Описание:** Два водителя едут навстречу друг другу. Каждый может свернуть или ехать прямо. Если оба едут прямо, происходит авария. Если один сворачивает, он проигрывает, а другой выигрывает.

**Матрица выигрышей:**

|                     | Водитель 2: Свернуть | Водитель 2: Ехать прямо |
|---------------------|----------------------|-------------------------|
| **Водитель 1: Свернуть** | (0, 0)               | (-1, 1)                 |
| **Водитель 1: Ехать прямо** | (1, -1)              | (-100, -100)            |

**Вопросы:**
1. Найдите равновесия Нэша.
2. Как можно избежать худшего исхода (аварии)?

**Ответ:**
1. Равновесия Нэша — (Свернуть, Ехать прямо) и (Ехать прямо, Свернуть).
2. Игроки могут договориться или использовать смешанные стратегии для снижения риска.

---

### Пример 6: Игра "Охота на оленя"
**Описание:** Два охотника могут охотиться на зайца (маленькая добыча) или на оленя (большая добыча). Чтобы поймать оленя, нужно сотрудничать.

**Матрица выигрышей:**

|                     | Охотник 2: Заяц | Охотник 2: Олень |
|---------------------|-----------------|------------------|
| **Охотник 1: Заяц**  | (2, 2)          | (2, 0)           |
| **Охотник 1: Олень** | (0, 2)          | (5, 5)           |

**Вопросы:**
1. Найдите равновесия Нэша.
2. Почему сотрудничество выгоднее, но игроки могут выбрать охоту на зайца?

**Ответ:**
1. Равновесия Нэша — (Заяц, Заяц) и (Олень, Олень).
2. Охота на зайца — безопасный выбор, так как она гарантирует выигрыш, даже если другой охотник не сотрудничает.

---

### Пример 7: Игра "Ястребы и голуби"
**Описание:** Два животных конкурируют за ресурс. "Ястреб" всегда атакует, "голубь" всегда уступает. Если оба "ястреба", они травмируют друг друга. Если оба "голубя", делят ресурс.

**Матрица выигрышей:**

|                     | Игрок 2: Ястреб | Игрок 2: Голубь |
|---------------------|-----------------|-----------------|
| **Игрок 1: Ястреб**  | (-2, -2)        | (4, 0)          |
| **Игрок 1: Голубь**  | (0, 4)          | (2, 2)          |

**Вопросы:**
1. Найдите равновесие Нэша.
2. Какую стратегию выгоднее использовать в долгосрочной перспективе?

**Ответ:**
1. Равновесие Нэша — смешанная стратегия, где каждый игрок выбирает "ястреба" с вероятностью 0.5.
2. В долгосрочной перспективе выгоднее использовать смешанную стратегию, чтобы минимизировать потери.

---

### Пример 8: Игра "Трагедия общин"
**Описание:** Несколько фермеров используют общий пастбищный ресурс. Каждый может увеличить количество своих животных, но это приводит к истощению ресурса.

**Вопросы:**
1. Почему каждый фермер стремится увеличить количество животных, даже если это вредит всем?
2. Как можно решить эту проблему?

**Ответ:**
1. Это равновесие Нэша, так как каждый фермер максимизирует свою выгоду, не учитывая общие последствия.
2. Решение — введение ограничений или штрафов за превышение норм.

---

## Пример 1: Игра "Общественное благо"

**Описание:** Несколько игроков (например, жители деревни) решают, сколько денег вложить в общественное благо (например, строительство дороги). Чем больше вложений, тем лучше результат для всех, но каждый игрок может решить сэкономить, надеясь на вложения других.

**Правила:**
- Каждый игрок имеет начальный капитал (например, 10 монет).
- Каждый решает, сколько монет вложить в общественное благо (от 0 до 10).
- Сумма вложений удваивается и делится поровну между всеми игроками.

**Пример с тремя игроками:**
- Игрок 1 вкладывает 5 монет.
- Игрок 2 вкладывает 3 монеты.
- Игрок 3 вкладывает 0 монет.
- Общая сумма вложений: 8 монет.
- Удвоенная сумма: 16 монет.
- Каждый игрок получает: 16 / 3 ≈ 5.33 монеты.

**Выигрыши:**
- Игрок 1: 10 - 5 + 5.33 = 10.33 монеты.
- Игрок 2: 10 - 3 + 5.33 = 12.33 монеты.
- Игрок 3: 10 - 0 + 5.33 = 15.33 монеты.

**Вопросы:**
1. Почему игроку 3 выгодно не вкладывать ничего?
2. Как можно мотивировать игроков вкладывать больше?

**Ответ:**
1. Игрок 3 получает выгоду от вложений других, не тратя свои ресурсы.
2. Можно ввести штрафы для тех, кто не вкладывает, или поощрения для активных участников.

---

## Пример 2: Игра "Аукцион с общим призом"

**Описание:** Несколько игроков участвуют в аукционе, где приз достаётся тому, кто сделает самую высокую ставку. Однако все игроки, кроме победителя, также платят свои ставки.

**Правила:**
- Каждый игрок делает ставку (от 1 до 10 монет).
- Игрок с самой высокой ставкой получает приз (например, 20 монет).
- Все игроки, включая победителя, платят свои ставки.

**Пример с четырьмя игроками:**
- Игрок 1: ставка 5 монет.
- Игрок 2: ставка 7 монет.
- Игрок 3: ставка 3 монет.
- Игрок 4: ставка 6 монет.

**Результат:**
- Победитель: Игрок 2 (ставка 7 монет).
- Выигрыш Игрока 2: 20 - 7 = 13 монет.
- Выигрыши остальных:
  - Игрок 1: -5 монет.
  - Игрок 3: -3 монет.
  - Игрок 4: -6 монет.

**Вопросы:**
1. Почему игроки могут делать высокие ставки, даже если это рискованно?
2. Как можно изменить правила, чтобы снизить риск для участников?

**Ответ:**
1. Игроки стремятся выиграть приз, но рискуют потерять свои ставки.
2. Можно ввести ограничение на максимальную ставку или уменьшить штраф для проигравших.

---

## Практические задачи

### Задача 1: Найти равновесие Нэша
Дана матрица выигрышей:

|           | Игрок 2: X | Игрок 2: Y |
|-----------|------------|------------|
| **Игрок 1: A** | (2, 2)     | (0, 3)     |
| **Игрок 1: B** | (3, 0)     | (1, 1)     |

Найдите равновесие Нэша.

### Задача 2: Симуляция игры
Напишите программу на Python, которая симулирует игру "Камень-ножницы-бумага" и выводит результаты 10 раундов.

---

## Домашнее задание

1. Решите задачу на поиск равновесия Нэша в игре с матрицей выигрышей:

|           | Игрок 2: L | Игрок 2: R |
|-----------|------------|------------|
| **Игрок 1: U** | (4, 4)     | (1, 3)     |
| **Игрок 1: D** | (3, 1)     | (2, 2)     |

2. Напишите программу на Python, которая симулирует игру "Дилемма заключённого" 100 раз и подсчитывает, сколько раз игроки выбирали "Сотрудничать" и "Предать".

---
